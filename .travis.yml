language: node_js

install:
- cd extension; npm install; cd ..

env: # important! Without the top-level env, no job will be allowed to fail.
  - JOB_DEFAULT=test

matrix:
  fast_finish: true
  include:
    - node_js: 8
      env: TYPE=UNIT_CODESTYLE_DEPENDENCY
      script:
      - cd extension
      - npm run test
      - npm run lint
      - npm run check
    - node_js: 8
      env: TYPE=INTEGRATION
      script:
      - if [[ "$INTEGRATION_CREDENTIALS" ]]; then echo "${INTEGRATION_CREDENTIALS}" > .integration-credentials.js; fi
      - cd extension
      - if [[ "$INTEGRATION_CREDENTIALS" ]]; then npm run testIntegration; fi
  allow_failures:
    - node_js: 8
      env: TYPE=INTEGRATION

notifications:
  slack:
    on_success: change
    on_failure: always
    secure: ePQ35SDp8wjFAW+TF/M+2jFQkiQ6PNgGzzGZVDLHr0S80nRHfICzTBUkdms6oN7QwMGRTmTzEWWrXQKmw+7NQuh13Yom46ztOflzi+dW5XeiybevXmMhK9NGPYAriT7T8NoR7cDaPf9L07/eDl0EfvgfXHaAOLHFi2zvvV+8rWCAEauSaSrHX7XTmyjjS2FtZiDhumoil4U0yi8AeKOXBxxTJDRrfNeRIfnFlEXUEuymvN/J4Ab5Yt9vMkDsbEInMhJ0var+E46cXX45zyQDeDiDbXb8eXjsOBw32X8TmWX48yDWrlJ10fJj5J00BzPbHAB7WLnKLoX5c9AnMSlfKxbFymsoxBx/MB0i8OQzOAo4bJt6AT2VCBzQU/wPxzYIy5rSv/4X35dANDoV8pkrf/IdiMELPIVwN2JhJDQjBq7ZRyY9hkqz6ZHTPs3xMGLAuleSYzlr6HDX9foY1ljd65YV4MlXoTKdXFyK1ezRT9n2sX5wqWl2G+To5ESr32D522lG+17/IKAAckQkUw2RS5fzveWH2WmKWqNd+9TwMnxaC0OIAMHprpJalRFeXS7ev5e3lwvNa+zkDVzF0zG12vBtLxtfFx07nbBEOhwddLMyzNWiWtD69y/YkFvXXOBhZqzkZmOf9P0JefsSa4RLFhKHHUzvOlAd2GomhxrYYdo=
